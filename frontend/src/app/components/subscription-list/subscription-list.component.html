<div class="subscription-list">
  @if (loading) {
    <div class="loading">
      <div class="spinner-large"></div>
      <p>Carregando assinaturas...</p>
    </div>
  } @else if (subscriptions.length === 0) {
    <div class="empty-state">
      <h3>Nenhuma assinatura ainda</h3>
      <p>Adicione sua primeira assinatura para começar a gerenciá-las</p>
    </div>
  } @else {
    <div class="subscriptions-grid">
      @for (sub of subscriptions; track sub._id) {
        <div class="subscription-card" [class]="getStatusClass(sub.status || 'active')">
          <div class="card-header">
            <div class="service-info">
              <h3>{{ sub.name }}</h3>
              <span class="category">{{ sub.category }}</span>
            </div>
            <div class="card-actions">
              <button 
                class="action-btn edit-btn" 
                (click)="onEdit(sub)"
                title="Editar assinatura"
              >
                Editar
              </button>
              <button 
                class="action-btn delete-btn" 
                (click)="onDelete(sub._id)"
                title="Excluir assinatura"
              >
                Excluir
              </button>
            </div>
          </div>

          <div class="price-info">
            <span class="price">
              {{ getCurrencySymbol(sub.currency) }}{{ sub.price }}
            </span>
            <span class="frequency">/ {{ sub.frequency }}</span>
          </div>

          <div class="subscription-details">
            <div class="detail-row">
              <span class="detail-label">Status:</span>
              <span class="status-badge" [class]="getStatusClass(sub.status || 'active')">
                {{ sub.status || 'active' }}
              </span>
            </div>

            <div class="detail-row">
              <span class="detail-label">Pagamento:</span>
              <span class="detail-value">{{ sub.paymentMethod }}</span>
            </div>

            @if (sub.renewalDate) {
              <div class="detail-row">
                <span class="detail-label">Renovação:</span>
                <span class="detail-value">
                  {{ formatDate(sub.renewalDate) }}
                  @if (sub.status === 'active' && isRenewalSoon(sub.renewalDate)) {
                    <span class="renewal-soon">
                      (em {{ getDaysUntilRenewal(sub.renewalDate) }} dias)
                    </span>
                  }
                </span>
              </div>
            }

            <div class="detail-row">
              <span class="detail-label">Início:</span>
              <span class="detail-value">{{ formatDate(sub.startDate) }}</span>
            </div>
          </div>
        </div>
      }
    </div>
  }
</div>
